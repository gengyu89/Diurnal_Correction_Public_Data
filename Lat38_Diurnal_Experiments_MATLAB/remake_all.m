% script for remaking figures from MJT (N38)
% created by: Yu Geng
% 2020-01-04

clc
clf
clear all
close all


%% Collect info.

% reload raw data (from the *.txt file)
T = [11.1667, 11.5, 11.8333, 12.1667, 12.5, 12.8333, 13.1667, 13.5, 13.8333, 14.1667, 14.5, 14.8333, 15.1667, 15.5, 15.8333, 16.1667, 16.5, 16.8333, 17.1667, 17.5, 17.8333, 18.1667, 18.5, 18.8333, 19.1667, 19.5, 19.8333, 20.1667, 20.5, 20.8333, 21.1667, 21.5, 21.8333, 22.1667, 22.5, 22.8333, 23.1667, 23.5, 23.8333, 24.1667, 24.5, 24.8333, 25.1667, 25.5, 25.8333, 26.1667, 26.5, 26.8333, 27.1667, 27.5, 27.8333, 28.1667, 28.5, 28.8333, 29.1667, 29.5, 29.8333, 30.1667, 30.5, 30.8333, 31.1667, 31.5, 31.8333, 32.1667, 32.5, 32.8333, 33.1667, 33.5, 33.8333, 34.1667, 34.5, 34.8333, 35.1667, 35.5, 35.8333, 36.1667, 36.5, 36.8333, 37.1667, 37.5, 37.8333, 38.1667, 38.5, 38.8333, 39.1667, 39.5, 39.8333, 40.1667, 40.5, 40.8333, 41.1667, 41.5, 41.8333, 42.1667, 42.5, 42.8333, 43.1667, 43.5];
V12 = [-0.7816, -0.6806, -0.5795, -0.3785, -0.4775, -0.1764, 0.0246, 0.0256, 0.1266, 0.1277, 0.3287, 0.4297, 0.4308, 0.5318, 0.6328, 0.8339, 0.9349, 1.0359, 1.037, 1.038, 1.139, 1.14, 1.2411, 1.2421, 1.3431, 1.4442, 1.4452, 1.4462, 1.5473, 1.6483, 1.6493, 1.5504, 1.3514, 1.5524, 1.4535, 1.4545, 1.2555, 1.2565, 1.2576, 1.1586, 1.2596, 1.0607, 1.0617, 1.0627, 0.8638, 0.7648, 0.7658, 0.6669, 0.5679, 0.3689, 0.3699, 0.271, 0.072, 0.073, -0.0259, -0.1249, -0.3239, -0.3228, -0.4218, -0.5208, -0.7197, -0.8187, -0.9177, -1.0167, -1.1156, -1.2146, -1.3136, -1.5125, -1.6115, -1.6105, -1.7094, -1.7084, -1.8074, -1.8063, -1.8053, -1.8043, -1.8032, -1.9022, -1.6012, -1.5002, -1.3991, -1.3981, -1.2971, -1.096, -1.095, -0.994, -0.8929, -0.7919, -0.5909, -0.4898, -0.3888, -0.1878, -0.1868, -0.1857, 0.1153, 0.1163, 0.2174, 0.3184];
V13 = [0.77959, 0.47856, 0.57753, 0.4765, 0.47547, 0.37444, 0.4734, 0.37237, 0.37134, 0.37031, 0.26928, 0.26825, 0.16722, 0.16619, 0.06516, -0.13587, -0.1369, -0.13794, -0.13897, -0.24, -0.34103, -0.34206, -0.44309, -0.44412, -0.54515, -0.44618, -0.54721, -0.54825, -0.54928, -0.55031, -0.45134, -0.65237, -0.5534, -0.55443, -0.55546, -0.65649, -0.65752, -0.55855, -0.55959, -0.56062, -0.46165, -0.56268, -0.56371, -0.56474, -0.56577, -0.5668, -0.56783, -0.46886, -0.46989, -0.47093, -0.47196, -0.47299, -0.37402, -0.47505, -0.37608, -0.27711, -0.37814, -0.27917, -0.2802, -0.38123, -0.38227, -0.2833, -0.28433, -0.28536, -0.18639, -0.08742, -0.18845, -0.08948, -0.09051, 0.10846, 0.20743, 0.40639, 0.50536, 0.70433, 0.7033, 0.80227, 0.90124, 1.00021, 0.89918, 0.99815, 0.89712, 0.89608, 0.79505, 0.89402, 0.79299, 0.59196, 0.59093, 0.5899, 0.48887, 0.48784, 0.38681, 0.28578, 0.38474, 0.28371, 0.28268, 0.18165, 0.28062, 0.17959];
E = [0.00551824, 0.00415905, 0.00408968, 0.00304186, 0.00336841, 0.00206895, 0.00236946, 0.00186567, 0.00196105, 0.00195797, 0.00212407, 0.0025322, 0.00231008, 0.00278523, 0.00318009, 0.00422363, 0.0047234, 0.00522416, 0.0052303, 0.00532583, 0.00594355, 0.00594982, 0.00658772, 0.00659416, 0.00724603, 0.00755618, 0.00772499, 0.00773151, 0.00820777, 0.00868686, 0.00854793, 0.00840848, 0.00730002, 0.00824043, 0.00777844, 0.00797721, 0.00708469, 0.00687377, 0.0068809, 0.00643412, 0.00670624, 0.00600218, 0.00600901, 0.00601584, 0.00516176, 0.00475854, 0.00476562, 0.00407514, 0.00368457, 0.00299028, 0.00299741, 0.00272485, 0.00190385, 0.00240239, 0.00188427, 0.00151934, 0.00248883, 0.00213334, 0.00253134, 0.00322634, 0.0040737, 0.00433074, 0.00480268, 0.00527884, 0.00565417, 0.00608749, 0.0066339, 0.00757421, 0.00806858, 0.00806912, 0.00860796, 0.00877855, 0.00938166, 0.00969173, 0.00968521, 0.00987096, 0.0100772, 0.0107433, 0.00917992, 0.00900748, 0.00830816, 0.00830115, 0.00760511, 0.00707021, 0.00675831, 0.00578325, 0.00535241, 0.00493615, 0.00383363, 0.00345561, 0.00274151, 0.00170934, 0.00213783, 0.00169494, 0.001526, 0.00107815, 0.00177442, 0.00182737];
phi = [2.35754, 2.52881, 2.35795, 2.24213, 2.35838, 2.0111, 1.51887, 1.50215, 1.24219, 1.23869, 0.686301, 0.558027, 0.370222, 0.302858, 0.102598, -0.161496, -0.145384, -0.132366, -0.133203, -0.227197, -0.290887, -0.291475, -0.342875, -0.343355, -0.385535, -0.299613, -0.361921, -0.362321, -0.341081, -0.322196, -0.267088, -0.398248, -0.388632, -0.34299, -0.364991, -0.423936, -0.482391, -0.418254, -0.418619, -0.450623, -0.351267, -0.487688, -0.488055, -0.488421, -0.579816, -0.637734, -0.637977, -0.612714, -0.691182, -0.906241, -0.905988, -1.05046, -1.3806, -1.4183, -1.63956, -1.99429, -2.27914, -2.4286, -2.55528, -2.50976, -2.65338, -2.80849, -2.84117, -2.86799, -2.97606, -3.06975, -2.99912, -3.08251, -3.08549, 3.07436, 3.02085, 2.90808, 2.86898, 2.76983, 2.77014, 2.72324, 2.67815, 2.65755, 2.62996, 2.55456, 2.57147, 2.57167, 2.59176, 2.4574, 2.51487, 2.60451, 2.55701, 2.50141, 2.45046, 2.35825, 2.35882, 2.15223, 2.02284, 2.15041, 1.18348, 1.00126, 0.911612, 0.513511];
phi_prime = [2.35754, 2.52881, 2.35795, 2.24213, 2.35838, 2.0111, 1.51887, 1.50215, 1.24219, 1.23869, 0.686301, 0.558027, 0.370222, 0.302858, 0.102598, -0.161496, -0.145384, -0.132366, -0.133203, -0.227197, -0.290887, -0.291475, -0.342875, -0.343355, -0.385535, -0.299613, -0.361921, -0.362321, -0.341081, -0.322196, -0.267088, -0.398248, -0.388632, -0.34299, -0.364991, -0.423936, -0.482391, -0.418254, -0.418619, -0.450623, -0.351267, -0.487688, -0.488055, -0.488421, -0.579816, -0.637734, -0.637977, -0.612714, -0.691182, -0.906241, -0.905988, -1.05046, -1.3806, -1.4183, -1.63956, -1.99429, -2.27914, -2.4286, -2.55528, -2.50976, -2.65338, -2.80849, -2.84117, -2.86799, -2.97606, -3.06975, -2.99912, -3.08251, -3.08549, -3.20883, -3.26234, -3.37511, -3.41421, -3.51336, -3.51305, -3.55995, -3.60504, -3.62564, -3.65323, -3.72863, -3.71172, -3.71152, -3.69143, -3.82579, -3.76832, -3.67868, -3.72618, -3.78178, -3.83273, -3.92494, -3.92437, -4.13096, -4.26035, -4.13278, -5.09971, -5.28193, -5.371578, -5.769679];

% potential distances
L12 = 200.04;
L13 = 200.062;

% tips for looking for extrema values
% >> subE = E((T>25) & (T<35))
% >> find(E == min(subE))
% and then T(56) gives the corresponding time

% examine output directory
pltdir = './remake/';
if ~exist(pltdir, 'dir')
    mkdir(pltdir);
end


%% Start making plots.

% initialize line width
set(0, 'DefaultLineLineWidth', 1.5)

disp('Plotting potential differences...');

plt_potential(pltdir, T, V12, V13, true);  % in both languages
plt_potential(pltdir, T, V12, V13, false); % in English only

disp('Plotting diurnal variations...');

plt_diurnal_seg(pltdir, T, E, phi, true);  % in both languages
plt_diurnal_seg(pltdir, T, E, phi, false); % in English only

disp('Plotting diurnal locus...');

plt_locus(pltdir, T, V12, V13, L12, L13, true);  % in both languages
plt_locus(pltdir, T, V12, V13, L12, L13, false); % in English only

% restore default width
set(0, 'DefaultLineLineWidth', 0.5)

